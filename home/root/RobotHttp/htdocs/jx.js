jx={getHTTPObject:function(){var http=false;if(typeof ActiveXObject!='undefined'){try{http=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{http=new ActiveXObject("Microsoft.XMLHTTP");}catch(E){http=false;}}}else if(window.XMLHttpRequest){try{http=new XMLHttpRequest();if(http.withCredentials===undefined){console.log("IE8/9 XDomainRequest");http=new XDomainRequest();}}catch(e){http=false;}}return http;},load:function(url,format,method,opt,uuid,data){return new Promise(function(resolve,reject){var http=this.init();var _this=this;if(!http||!url)reject("AJAX object or url invalid!");if(!format)format="text";if(!opt)opt={};if(!data)data="";if(!method)method="GET";let payload="";http.withCredentials=true;format=format.toLowerCase();method=method.toUpperCase();if(typeof data=="object"){payload=Object.keys(data).map(key=>{return key+'='+data[key];}).join('&');}else if(typeof data=="string"){payload=data;}let now='tm='+new Date().getTime();url+='\?uid='+uuid+'&'+now;this.waitC(opt);http.open(method,url,true);http.setRequestHeader('X-Requested-With','XMLHttpRequest');http.setRequestHeader('x-mac','AA:BB:CC:00:11:22');http.onreadystatechange=function(){if(http.readyState==4){if(http.status==200){var ct=http.getResponseHeader("content-type")||"";var res="";if(ct.indexOf('html')>-1){console.warn("JX: got html data??");}else if(ct.indexOf('json')>-1){res=JSON.parse(http.responseText);}else{_this.completeC(opt);reject("Content type not supported: "+ct);}_this.completeC(opt);resolve(res);}else{_this.completeC(opt);reject("HTTP error: "+http.status);}}};if(payload.length>0){http.send(payload);}else{http.send(null);}}.bind(this));},waitC:function(opt){if(opt!="timer"){document.body.style.cursor="wait";}},completeC:function(opt){document.body.style.cursor='default';},init:function(){return this.getHTTPObject();}};